<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.9.2" />
<title>pycollector.project API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}#lunr-search{width:100%;font-size:1em;padding:6px 9px 5px 9px;border:1px solid silver}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>pycollector.project</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/visym/collector/blob/588c5b34d88911bd08ea60cd0b0803824e255f89/pycollector/project.py#L0-L118" class="git-link">Browse git</a>
</summary>
<pre><code class="python">import os
import vipy
import warnings
import numpy as np
import pandas as pd
import json
import ast

from pycollector.globals import print, GLOBALS
from pycollector.video import Video
from pycollector.user import User


class Project(User):
    &#34;&#34;&#34;collector.project.Project class

    Projects() are sets of CollectionInstances() and Instances() in a program.
    &#34;&#34;&#34;

    def __init__(
            self,
            project=None,
            program=None,
            weeksago=None,
            monthsago=None,
            daysago=None,
            since=None,
            before=None,
            alltime=False,
            last=None,
            retry=2,
            username=None,
            password=None,
    ):
        super().__init__(username=username, password=password)

        if not self.refresh().is_authenticated():
            self.login()

        self._projects = None
        self._programid = self.cognito_username if program is None else program
        self.df = pd.DataFrame()

        # Get data from backend lambda function
        # Invoke Lambda function
        request = {
            &#34;program&#34;: self._programid,
            &#34;project&#34;: project,
            &#34;weeksago&#34;: weeksago,
            &#34;monthsago&#34;: monthsago,
            &#34;daysago&#34;: daysago,
            &#34;since&#34;: since,
            &#34;alltime&#34;: alltime,
            &#34;Video_IDs&#34;: None,
            &#34;before&#34;: before,
            &#34;week&#34;: None,
            &#34;pycollector_id&#34;: self.cognito_username,
            &#34;last&#34;: last,
        }

        FunctionName = self.get_ssm_param(GLOBALS[&#34;LAMBDA&#34;][&#34;get_project&#34;])

        for k in range(0, retry):
            try:
                response = self.lambda_client.invoke(
                    FunctionName=FunctionName,
                    InvocationType=&#34;RequestResponse&#34;,
                    LogType=&#34;Tail&#34;,
                    # Payload=json.dumps(request),
                    Payload=bytes(json.dumps(request), encoding=&#34;utf8&#34;),
                )

                # Get the serialized dataframe
                dict_str = response[&#34;Payload&#34;].read().decode(&#34;UTF-8&#34;)
                if dict_str == &#34;null&#34;:
                    raise ValueError(&#34;Invalid lambda function response&#34;)
                data_dict = ast.literal_eval(dict_str)

                if &#39;body&#39; in data_dict:
                    serialized_videos_data_dict = data_dict[&#34;body&#34;][&#34;videos&#34;]
                    if len(serialized_videos_data_dict) &gt; 0:
                        data_df = pd.read_json(serialized_videos_data_dict)
                        self.df = data_df
                    else:
                        self.df = []
                else:
                    raise ValueError(&#39;Invalid request - Error &#34;%s&#34;&#39; % (str(data_dict)))

            except Exception as e:
                if &#34;expired&#34; in str(e):
                    self.login()  # try one more time
                else:
                    raise

        #print(&#34;[pycollector.project]:  Returned %d videos&#34; % len(self.df))

    def __repr__(self):
        return str(&#34;&lt;pycollector.project: program=%s, videos=%d&gt;&#34; % (self._programid, len(self)))

    def __len__(self):
        return len(self.df)

    def __getitem__(self, k):
        if isinstance(k, int):
            return Video(mp4url=self.df.iloc[k].raw_video_file_path, jsonurl=self.df.iloc[k].annotation_file_path)
        elif isinstance(k, slice):
            return [Video(mp4url=v, jsonurl=a) for (v, a) in zip(self.df.iloc[k].raw_video_file_path, self.df.iloc[k].annotation_file_path)]
        else:
            raise ValueError(&#39;Invalid index &#34;%s&#34;&#39; % (str(k)))

    def videos(self):
        return sorted([v for v in self], key=lambda v: v.uploaded(), reverse=True)

    def last(self, n=1):
        assert len(self) &gt;= n, &#34;Invalid length (videos=%d &lt; n=%d)&#34; % (len(self), n)
        V = self.videos()[-n:]
        return V if n &gt; 1 else V[0]</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="pycollector.project.Project"><code class="flex name class">
<span>class <span class="ident">Project</span></span>
<span>(</span><span>project=None, program=None, weeksago=None, monthsago=None, daysago=None, since=None, before=None, alltime=False, last=None, retry=2, username=None, password=None)</span>
</code></dt>
<dd>
<div class="desc"><p>collector.project.Project class</p>
<p>Projects() are sets of CollectionInstances() and Instances() in a program.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>username</code></strong> :&ensp;<code>[str]</code></dt>
<dd>username of pycollector.</dd>
<dt><strong><code>password</code></strong> :&ensp;<code>[str]</code>, optional</dt>
<dd>password for the user. Defaults to None.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/visym/collector/blob/588c5b34d88911bd08ea60cd0b0803824e255f89/pycollector/project.py#L14-L117" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class Project(User):
    &#34;&#34;&#34;collector.project.Project class

    Projects() are sets of CollectionInstances() and Instances() in a program.
    &#34;&#34;&#34;

    def __init__(
            self,
            project=None,
            program=None,
            weeksago=None,
            monthsago=None,
            daysago=None,
            since=None,
            before=None,
            alltime=False,
            last=None,
            retry=2,
            username=None,
            password=None,
    ):
        super().__init__(username=username, password=password)

        if not self.refresh().is_authenticated():
            self.login()

        self._projects = None
        self._programid = self.cognito_username if program is None else program
        self.df = pd.DataFrame()

        # Get data from backend lambda function
        # Invoke Lambda function
        request = {
            &#34;program&#34;: self._programid,
            &#34;project&#34;: project,
            &#34;weeksago&#34;: weeksago,
            &#34;monthsago&#34;: monthsago,
            &#34;daysago&#34;: daysago,
            &#34;since&#34;: since,
            &#34;alltime&#34;: alltime,
            &#34;Video_IDs&#34;: None,
            &#34;before&#34;: before,
            &#34;week&#34;: None,
            &#34;pycollector_id&#34;: self.cognito_username,
            &#34;last&#34;: last,
        }

        FunctionName = self.get_ssm_param(GLOBALS[&#34;LAMBDA&#34;][&#34;get_project&#34;])

        for k in range(0, retry):
            try:
                response = self.lambda_client.invoke(
                    FunctionName=FunctionName,
                    InvocationType=&#34;RequestResponse&#34;,
                    LogType=&#34;Tail&#34;,
                    # Payload=json.dumps(request),
                    Payload=bytes(json.dumps(request), encoding=&#34;utf8&#34;),
                )

                # Get the serialized dataframe
                dict_str = response[&#34;Payload&#34;].read().decode(&#34;UTF-8&#34;)
                if dict_str == &#34;null&#34;:
                    raise ValueError(&#34;Invalid lambda function response&#34;)
                data_dict = ast.literal_eval(dict_str)

                if &#39;body&#39; in data_dict:
                    serialized_videos_data_dict = data_dict[&#34;body&#34;][&#34;videos&#34;]
                    if len(serialized_videos_data_dict) &gt; 0:
                        data_df = pd.read_json(serialized_videos_data_dict)
                        self.df = data_df
                    else:
                        self.df = []
                else:
                    raise ValueError(&#39;Invalid request - Error &#34;%s&#34;&#39; % (str(data_dict)))

            except Exception as e:
                if &#34;expired&#34; in str(e):
                    self.login()  # try one more time
                else:
                    raise

        #print(&#34;[pycollector.project]:  Returned %d videos&#34; % len(self.df))

    def __repr__(self):
        return str(&#34;&lt;pycollector.project: program=%s, videos=%d&gt;&#34; % (self._programid, len(self)))

    def __len__(self):
        return len(self.df)

    def __getitem__(self, k):
        if isinstance(k, int):
            return Video(mp4url=self.df.iloc[k].raw_video_file_path, jsonurl=self.df.iloc[k].annotation_file_path)
        elif isinstance(k, slice):
            return [Video(mp4url=v, jsonurl=a) for (v, a) in zip(self.df.iloc[k].raw_video_file_path, self.df.iloc[k].annotation_file_path)]
        else:
            raise ValueError(&#39;Invalid index &#34;%s&#34;&#39; % (str(k)))

    def videos(self):
        return sorted([v for v in self], key=lambda v: v.uploaded(), reverse=True)

    def last(self, n=1):
        assert len(self) &gt;= n, &#34;Invalid length (videos=%d &lt; n=%d)&#34; % (len(self), n)
        V = self.videos()[-n:]
        return V if n &gt; 1 else V[0]</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="pycollector.user.User" href="user.html#pycollector.user.User">User</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="pycollector.project.Project.last"><code class="name flex">
<span>def <span class="ident">last</span></span>(<span>self, n=1)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/visym/collector/blob/588c5b34d88911bd08ea60cd0b0803824e255f89/pycollector/project.py#L114-L117" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def last(self, n=1):
    assert len(self) &gt;= n, &#34;Invalid length (videos=%d &lt; n=%d)&#34; % (len(self), n)
    V = self.videos()[-n:]
    return V if n &gt; 1 else V[0]</code></pre>
</details>
</dd>
<dt id="pycollector.project.Project.videos"><code class="name flex">
<span>def <span class="ident">videos</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/visym/collector/blob/588c5b34d88911bd08ea60cd0b0803824e255f89/pycollector/project.py#L111-L112" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def videos(self):
    return sorted([v for v in self], key=lambda v: v.uploaded(), reverse=True)</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="pycollector.user.User" href="user.html#pycollector.user.User">User</a></b></code>:
<ul class="hlist">
<li><code><a title="pycollector.user.User.add_user_to_group" href="user.html#pycollector.user.User.add_user_to_group">add_user_to_group</a></code></li>
<li><code><a title="pycollector.user.User.get_ssm_param" href="user.html#pycollector.user.User.get_ssm_param">get_ssm_param</a></code></li>
<li><code><a title="pycollector.user.User.is_token_expired" href="user.html#pycollector.user.User.is_token_expired">is_token_expired</a></code></li>
<li><code><a title="pycollector.user.User.login" href="user.html#pycollector.user.User.login">login</a></code></li>
</ul>
</li>
</ul>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<header>
<a class="homelink" rel="home" title="Visym Collector" href="https://github.com/visym/collector/">
<img src="https://www.visym.com/labs/images/visym_logo_black_notext.png" alt="" width="150"> <p> </p>
</a>
</header>
<form>
<input id="lunr-search" name="q" placeholder="🔎 Search ..." aria-label="Search"
disabled minlength="2">
</form>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/tingle/0.15.3/tingle.min.css" integrity="sha512-j1u8eUJ4f23xPPxwOrLUPQaCD2dwzNqqmDDcWS4deWsMv2ohLqmXXuP3hU7g8TyzbMSakP/mMqoNBYWj8AEIFg==" crossorigin>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tingle/0.15.3/tingle.min.js" integrity="sha512-plGUER9JkeEWPPqQBE4sdLqBoQug5Ap+BCGMc7bJ8BXkm+VVj6QzkpBz5Yv2yPkkq+cqg9IpkBaGCas6uDbW8g==" crossorigin></script>
<style>
.modal-dialog iframe {
width: 100vw;
height: calc(100vh - 80px);
}
@media screen and (min-width: 700px) {
.modal-dialog iframe {
width: 70vw;
height: 80vh;
}
}
.modal-dialog .tingle-modal-box {width: auto;}
.modal-dialog .tingle-modal-box__content {padding: 0;}
</style>
<script>
const input = document.getElementById('lunr-search');
input.disabled = false;
input.form.addEventListener('submit', (ev) => {
ev.preventDefault();
const url = new URL(window.location);
url.searchParams.set('q', input.value);
history.replaceState({}, null, url.toString());
search(input.value);
});
const query = new URL(window.location).searchParams.get('q');
if (query)
search(query);
function search(query) {
const url = '../doc-search.html#' + encodeURIComponent(query);
new tingle.modal({
cssClass: ['modal-dialog'],
onClose: () => {
const url = new URL(window.location);
url.searchParams.delete('q');
history.replaceState({}, null, url.toString());
setTimeout(() => input.focus(), 100);
}
}).setContent('<iframe src="' + url + '"></iframe>').open();
}
</script>
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="pycollector" href="index.html">pycollector</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="pycollector.project.Project" href="#pycollector.project.Project">Project</a></code></h4>
<ul class="">
<li><code><a title="pycollector.project.Project.last" href="#pycollector.project.Project.last">last</a></code></li>
<li><code><a title="pycollector.project.Project.videos" href="#pycollector.project.Project.videos">videos</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.9.2</a>.</p>
</footer>
</body>
</html>